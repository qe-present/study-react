const{hash}=require("bcryptjs"),{v4:generateId}=require("uuid"),{NotFoundError}=require("../util/errors"),{readData,writeData}=require("./util");async function add(r){const e=await readData(),a=generateId(),t=await hash(r.password,12);return e.users||(e.users=[]),e.users.push({...r,password:t,id:a}),await writeData(e),{id:a,email:r.email}}async function get(r){const e=await readData();if(!e.users||0===e.users.length)throw new NotFoundError("Could not find any users.");const a=e.users.find((e=>e.email===r));if(!a)throw new NotFoundError("Could not find user for email "+r);return a}exports.add=add,exports.get=get;